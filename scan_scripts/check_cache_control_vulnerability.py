import sys

def check_cache_control_vulnerability(headers):
    if 'cache-control' not in headers or ('no-store' not in headers['cache-control'] and 'no-cache' not in headers['cache-control']):
        return {
            'name': 'Cache Control',
            'description': 'Missing or misconfigured Cache-Control header with no-store or no-cache directives.',
            'risk': 'Medium',
            'evidence': 'Cache-Control header does not include no-store or no-cache directives.'
        }
    return {
        'name': 'Cache Control',
        'description': 'No Cache Control vulnerability detected.',
        'risk': 'None',
        'evidence': 'Cache-Control header is properly configured.'
    }

if __name__ == "__main__":
    headers = sys.argv[1]

    vulnerability = check_cache_control_vulnerability(headers)
    if vulnerability:   
        print("\n")
        print("Cache Control Vulnerability Detection Status:")
        print(f"Name: {vulnerability['name']}")
        print(f"Description: {vulnerability['description']}")
        print(f"Risk: {vulnerability['risk']}")
        print(f"Evidence: {vulnerability['evidence']}")
        
